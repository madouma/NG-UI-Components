@import "../../styles/variables";
@import "../../styles/mixins";

$slider-min-height: map-get($heights, s);

$track-height: 3px;
$track-color: var(--slider-shade);

$handle-height: 13px;
$handle-width: 13px;
$handle-border-width: 2px;
$handle-fill-color: $track-color;
$handle-color: var(--primary-accent);
$handle-color-hover: var(--primary-accent-hover);
$handle-color-active: var(--primary-accent-active);
$handle-gap: 3px;

$units-color: var(--units);

$input-width: map-get($widths, xs);
$input-height: map-get($heights, s);
$input-horz-offset: 5px;
$input-vert-offset: 3px;

$label-min-width: $input-width - $input-horz-offset - map-get($x-spacings, m);

:host {
  display: flex;
  align-items: center;
  min-height: $slider-min-height;
}

.h2-slider-wrapper {
  height: $track-height;
  background-color: $track-color;
  padding: 0 $handle-width;
  @include control-box-margins;

  // Spacing
  @each $size, $width in $widths {
    &.h2--#{$size} {
      width: #{$width};
    }
  }
}

.h2-slider {
  position: relative;
  height: inherit;
  width: 100%;
}

.h2-slider-center-bar {
  position: absolute;
  height: $handle-height;
  top: 50%;
  margin-top: -$handle-height / 2;
  box-sizing: border-box;

  &::before {
    content: "";
    position: absolute;
    top: 0;
    bottom: 0;
    left: 50%;
    width: calc(100% - #{$handle-gap * 2});
    transform: translateX(-50%);
    display: block;
    height: inherit;
    background-color: $handle-fill-color;
    border: $handle-border-width solid $handle-color;
    box-sizing: border-box;
  }
}

.h2-slider-control {
  height: inherit;
  border: none;
  box-shadow: none;
  background-color: transparent;
}

.h2-slider-control.noUi-target ::ng-deep {
  .noUi-connects {
    background-color: $track-color;
    border-radius: 0;
  }

  .noUi-origin {
    top: 50%;
    transition: none;
  }

  .noUi-connects {
    overflow: visible;
    opacity: 0;
  }

  .noUi-connect {
    top: 50%;
    height: $handle-height;
    margin-top: -$handle-height / 2;
    transition: none;
  }

  .noUi-handle {
    background-color: $handle-fill-color;
    border: $handle-border-width solid $handle-color;
    box-shadow: none;
    outline: none;
    width: $handle-width;
    height: $handle-height;
    top: 50%;
    margin-top: -$handle-height / 2;
    cursor: pointer;
    transition: border-color $speed $timing;

    &:hover, &:focus {
      border-color: $handle-color-hover
    }

    &:active {
      border-color: $handle-color-active;
    }

    &::before, &::after {
      display: none;
    }
  }

  .noUi-handle-lower {
    right: 0;
    border-radius: 50% 0 0 50%;
  }

  .noUi-handle-upper {
    right: -$handle-width;
    border-radius: 0 50% 50% 0;
  }

  .noUi-tooltip {
    visibility: hidden;
  }
}

.h2-slider-units {
  color: $units-color;
}

h2-textbox {
  position: absolute;
  bottom: 100%;
  transition: transform $speed $timing;

  &.h2--left {
    margin-left: -$input-horz-offset;
    transform: translateX(-100%);
  }

  &.h2--right {
    margin-right: -$input-horz-offset;
    transform: translateX(100%);
  }

  &:focus-within {
    z-index: 2;

    &.h2--left {
      transform: translate(-100%, 12px);
    }

    &.h2--right {
      transform: translate(100%, 12px);
    }
  }
}

h2-label {
  min-width: $label-min-width;
}
